/*!
 * D3 Elements v0.1.2 (https://bitbucket.org/artstr/d3elements.git)
 * Copyright 2014-2015 Artana Pty Ltd
 * Licensed under MIT (https://bitbucket.org/artstr/d3elements/src/master/LICENSE)
 */
if("undefined"==typeof d3)throw new Error("This module requires d3");if("undefined"==typeof _)throw new Error("This module requires underscore");var d3=function(a,b){"use strict";function c(){function c(c){function x(c,x){function H(a){var c=b.filter(J,function(b){return b[0]===a});if(1!==c.length)throw"cannot find "+a+" in data";return c[0]}var I=h-(E?E.height():0);b.isArray(x[0])?b.each(x,function(a,b){a[0]=k.call(x,a,b),a[1]=l.call(x,a,b)}):x=b.map(x,function(a,b){return[k.call(x,a,b),l.call(x,a,b)]}),F||(F=[0,x.length-1]);var J=x.slice(F[0],F[1]+1);p.rangeBands([0,g-f.left-f.right],m).domain(b.map(J,function(a){return a[0]})),q.domain([a.functor(n)(J),a.functor(o)(J)]).range([I-f.top-f.bottom,0]);var K=a.select(c).selectAll("svg."+j).data([1]),L=K.enter().append("svg").attr("class",j).append("g");L.append("g").attr("class","bars"),L.append("g").attr("class","x axis"),L.append("g").attr("class","y axis");var M=K.select("g").attr("transform","translate("+f.left+","+f.top+")"),N=M.select("g.bars").selectAll("rect.bar").data(J,function(a){return a[0]});if(N.enter().append("rect").attr("class","bar").attr("x",d).attr("y",q(0)).attr("height",0).attr("width",p.rangeBand()).attr("fill",A).attr("stroke",B),N.on("mouseover",function(a){C(this,a)}).on("mouseout",function(a){D(this,a)}).transition().duration(i).attr("x",d).attr("y",function(a){return a[1]>0?e(a):q(0)}).attr("height",function(a){return Math.abs(e(a)-q(0))}).attr("width",p.rangeBand()).attr("fill",A).attr("stroke",B),N.exit().transition().duration(i).attr("y",q(0)).attr("height",0).remove(),K.attr("width",g).attr("height",I),r&&p.rangeBand()>=s?(t&&r.tickFormat(function(a){return t(H(a))}),v?M.select(".x.axis").transition().duration(i).attr("transform","translate(0,"+q(a.functor(w)(x))+")").call(r).selectAll("text").call(u):M.select(".x.axis").call(r).attr("transform","translate(0,"+q(a.functor(w)(x))+")").transition().duration(i).selectAll("text").call(u),M.select(".x.axis").selectAll("text").on("mouseover",function(a){C(this,H(a))}).on("mouseout",function(a){D(this,H(a))}).call(u),G=!0):G&&(M.select(".x.axis").selectAll(".tick").remove(),G=!1),y){var O=a.min(J,function(a){return a[1]}),P=a.max(J,function(a){return a[1]}),Q=[0];q(O)-q(0)>z?Q.push(O):0>O&&Q.push(q.invert(q(0)+z)),q(P)-q(0)<-z?Q.push(P):P>0&&Q.push(q.invert(q(0)-z)),y.scale(q).tickValues(Q),M.select(".y.axis").transition().duration(i).call(y)}}c.each(function(b){var c=this;x(c,b),E&&(E.width(g).margin({top:0,right:f.right,bottom:0,left:f.left}),E.onDrag(function(a,d){F=[Math.round(a),Math.round(d)];var e=i;i=0,x(c,b),i=e}),a.select(c).datum([{scale:a.scale.linear().domain([0,b.length-1]),start:F?F[0]:0,end:F?F[1]:b.length-1}]).call(E))})}function d(a){return p(a[0])}function e(a){return q(a[1])}var f={top:10,right:20,bottom:120,left:60},g=760,h=300,i=500,j="bar-chart",k=function(a){return a[0]},l=function(a){return a[1]},m=.1,n=function(b){return Math.min(0,a.min(b,function(a){return a[1]}))},o=function(b){return Math.max(0,a.max(b,function(a){return a[1]}))},p=a.scale.ordinal(),q=a.scale.linear(),r=a.svg.axis().scale(p).orient("bottom").tickSize(6,0),s=null,t=null,u=function(a){a.attr("x",-8).attr("y",0).attr("dy",".35em").attr("transform","rotate(-90)").style("text-anchor","end")},v=!0,w=0,x=a.format(",.0f"),y=a.svg.axis().orient("left").tickSize(6,0).tickFormat(x),z=18,A=function(a){return a[1]>=0?"#66BB66":"#BB6666"},B=function(a){return a[1]>=0?"gray":"#BB6666"},C=function(){},D=function(){},E=null,F=null,G=!1;return c.margin=function(a){return arguments.length?(f=a,c):f},c.width=function(a){return arguments.length?(g=a,c):g},c.height=function(a){return arguments.length?(h=a,c):h},c.duration=function(a){return arguments.length?(i=a,c):i},c.xPadding=function(a){return arguments.length?(m=a,c):m},c.xAxisText=function(a){return arguments.length?(u=a,c):u},c.yMin=function(a){return arguments.length?(n=a,c):n},c.yMax=function(a){return arguments.length?(o=a,c):o},c.xAxis=function(a){return arguments.length?(r=a,c):r},c.yAxis=function(a){return arguments.length?(y=a,c):y},c.xAxisIfBarsWiderThan=function(a){return arguments.length?(s=a,c):s},c.xAxisTickFormat=function(a){return arguments.length?(t=a,c):t},c.xAxisAnimate=function(a){return arguments.length?(v=a,c):v},c.yValueOfXAxis=function(a){return arguments.length?(w=a,c):w},c.x=function(a){return arguments.length?(k=a,c):k},c.y=function(a){return arguments.length?(l=a,c):l},c.mouseOver=function(a){return arguments.length?(C=a,c):C},c.mouseOut=function(a){return arguments.length?(D=a,c):D},c.stroke=function(a){return arguments.length?(B=a,c):B},c.fill=function(a){return arguments.length?(A=a,c):A},c.xDomain=function(a){return arguments.length?(F=a,c):F},c.rangeWidget=function(a){return arguments.length?(E=a,c):E},c.svgClass=function(a){return arguments.length?(j=a,c):j},c}return"undefined"==typeof a.elts&&(a.elts={}),a.elts.barChart=c,a}(d3,_),d3=function(a){"use strict";var b=function(b){function c(b,c,h){"undefined"==typeof b?d.transition().duration(g).style("opacity",1e-6).transition().style("z-index","-1").style("visibility","hidden"):(d.select(".click-panel-body").html(c),d.style("top",function(){return Math.min(a.event.pageY-e.top,Math.max(5,window.innerHeight-d[0][0].offsetHeight))+"px"}).style("left",function(){return Math.max(e.left,a.event.pageX-e.left-d[0][0].offsetWidth)+"px"}).style("visibility","visible").style("z-index","5").style("opacity",1e-6).transition().style("opacity",f),d.select(".close").on("click",function(){d.transition().style("opacity",1e-6).style("z-index","-1").style("visibility","hidden"),h()}))}var d=null,e={top:20,left:11},f=.9,g=500;"undefined"==typeof b&&(b="body"),d=a.select(b).selectAll("div.click-panel").data(["dummy"]);var h=d.enter().append("div").attr("class","click-panel");return h.append("div").attr("class","close").html("&times;"),h.append("div").attr("class","click-panel-body"),c.offset=function(a){return arguments.length?(e=a,c):e},c.opacity=function(a){return arguments.length?(f=a,c):f},c.autoCloseDuration=function(a){return arguments.length?(g=a,c):g},c};return"undefined"==typeof a.elts&&(a.elts={}),a.elts.makeClickPanel=b,a}(d3),d3=function(a){"use strict";function b(){function b(a){return a[0].map(function(b,c){return a.map(function(a){return a[c]})})}function c(a){for(var b=a.length,c=a[0].length,d=[],e=0;b+c>e;e++){for(var f=[],g=0;b+c>g;g++)f.push(g>=b&&b>e?a[e][g-b]:b>g&&e>=b?a[g][e-b]:0);d.push(f)}return d}function d(a,b){return function(c,d){a.selectAll(".flows path").filter(function(a){return a.source.index!==d&&a.target.index!==d}).transition().style("opacity",b)}}function e(b,c,d){var e=p[d];e||(e=d),b.html(e).style("top",function(){return Math.min(a.event.pageY-q.top,Math.max(5,window.innerHeight-b[0][0].offsetHeight))+"px"}).style("left",function(){return a.event.pageX+(c.angle>Math.PI?-b[0][0].offsetWidth-q.left:q.left)+"px"}).style("visibility","visible").style("opacity",1e-6).transition().style("opacity",1)}function f(a){a.transition().style("opacity",1e-6)}function g(g){g.each(function(g){l&&(g=b(g));var p=g.slice(1).map(function(a){return a.slice(1).map(function(a){return+a})}),q=g[0].slice(1),u=g.slice(1).map(function(a){return a[0]}),v=u.concat(q),w=c(p),x=a.layout.chord().padding(k).sortSubgroups(function(){return 1}).matrix(w),y=Math.min(i-h.left-h.right,j-h.top-h.bottom)/2,z=y-a.functor(o)(y),A=a.select(this).selectAll("div."+s).data(["TBD"]);A.enter().append("div").attr("class",s);var B=a.select(this).selectAll("svg."+r).data([g]),C=B.enter().append("svg").attr("class",r).append("g");C.append("g").attr("class","rim"),C.append("g").attr("class","labels"),C.append("g").attr("class","flows"),B.attr("width",i).attr("height",j),B.select("g").attr("transform","translate("+(i+h.left-h.right)/2+","+(j+h.top-h.bottom)/2+")");var D=B.select("g.rim").selectAll("path").data(x.groups);D.enter().append("path"),D.style("fill",function(a){return n(a.index)}).style("stroke",function(a){return n(a.index)}).attr("d",a.svg.arc().innerRadius(z).outerRadius(y)).on("mouseover",function(a,b){return e(A,a,v[a.index]),d(B,m)(a,b)}).on("mouseout",function(a,b){return f(A),d(B,1)(a,b)});var E=B.select("g.labels").selectAll("text").data(x.groups);E.enter().append("text"),E.attr("class","labels").each(function(a){a.angle=(a.startAngle+a.endAngle)/2}).attr("dy",".35em").attr("text-anchor",function(a){return a.angle>Math.PI?"end":null}).attr("transform",function(a){return"rotate("+(180*a.angle/Math.PI-90)+")translate("+(y+6)+")"+(a.angle>Math.PI?"rotate(180)":"")}).attr("class",function(a){return a.index<u.length?"row":"column"}).text(function(a){return a.endAngle-a.startAngle>t?v[a.index]:void 0});var F=B.select("g.flows").selectAll("path").data(x.chords);F.enter().append("path"),F.attr("d",a.svg.chord().radius(z)).style("fill",function(a){return n(a.target.index)}).style("opacity",1)})}var h={top:50,right:50,bottom:50,left:50},i=960,j=500,k=0,l=null,m=.2,n=a.scale.category20b(),o=function(a){return.1*a},p={},q={top:60,left:50},r="chord-diagram",s="chord-hover",t=0;return g.margin=function(a){return arguments.length?(h=a,g):h},g.width=function(a){return arguments.length?(i=a,g):i},g.height=function(a){return arguments.length?(j=a,g):j},g.arcPadding=function(a){return arguments.length?(k=a,g):k},g.rimWidth=function(a){return arguments.length?(o=a,g):o},g.colors=function(a){return arguments.length?(n=a,g):n},g.flip=function(){return l=!0,g},g.minAngleForLabel=function(a){return arguments.length?(t=a,g):t},g.hoverFadeOpacity=function(a){return arguments.length?(m=a,g):m},g.hoverHtml=function(a){return arguments.length?(p=a,g):p},g.hoverOffset=function(a){return arguments.length?(q=a,g):q},g.svgClass=function(a){return arguments.length?(r=a,g):r},g.hoverClass=function(a){return arguments.length?(s=a,g):s},g}return"undefined"==typeof a.elts&&(a.elts={}),a.elts.flowChord=b,a}(d3);if("undefined"==typeof d3)throw new Error("This module requires d3");var d3=function(a){"use strict";function b(){function b(b){function s(){var b=Math.atan(-a.event.x/a.event.y);if(-a.event.y<=0){if(a.event.x>0)b+=Math.PI;else if(b-=Math.PI,p)return 1}else if(p&&a.event.x<0)return 0;var c=(u+b-v)%u/u;return p&&(c=2*(u+b-r*u/360)%u/u),c}function t(b,n){n<o[0]&&(n=o[0]),n>o[1]&&(n=o[1]),q(n),p&&(v=-(n*u)/2+r*u/360);var w=n*u+v,x=d-c.left-c.right-2*l-2*m,y=e-c.top-c.bottom-2*l-2*m,z=Math.min(x,y)/2,A=a.svg.arc().innerRadius(0).outerRadius(z).startAngle(v),B=a.select(b).selectAll("svg."+f).data([n]);B.enter().append("svg").attr("class",f).append("g"),B.attr("height",e).attr("width",d);var C=B.select("g").attr("transform","translate("+(c.left+x/2+l+m)+","+(c.top+y/2+l+m)+")"),D=C.selectAll("path."+g).data([{endAngle:u+v}]);D.enter().append("path").attr("class",g),D.style("fill",j[0]).style("stroke",k[0]).style("stroke-width",l).attr("d",A);var E=C.selectAll("path."+h).data([{endAngle:w}]);E.enter().append("path").attr("class",h),E.style("fill",j[1]).style("stroke",k[1]).style("stroke-width",l).attr("d",A);var F=C.selectAll("circle."+i).data([w]);F.enter().append("circle").attr("class",i),F.style("fill",j[2]).style("stroke",k[2]).style("stroke-width",l).attr("cx",function(a){return z*Math.cos(a-u/4)}).attr("cy",function(a){return z*Math.sin(a-u/4)}).attr("r",m/2).style("cursor","pointer").call(a.behavior.drag().on("drag",function(){t(b,s())}))}var u=2*Math.PI,v=n/360*u;b.each(function(a){t(this,a[0])})}var c={top:0,right:0,bottom:0,left:0},d=220,e=220,f="prob-wheel",g="background",h="chosen",i="knob",j=["#CCCCCC","orange","#999999"],k=["white","white","white"],l=2,m=25,n=0,o=[0,1],p=!0,q=function(){},r=0;return b.margin=function(a){return arguments.length?(c=a,b):c},b.width=function(a){return arguments.length?(d=a,b):d},b.height=function(a){return arguments.length?(e=a,b):e},b.stroke=function(a){return arguments.length?(k=a,b):k},b.fill=function(a){return arguments.length?(j=a,b):j},b.strokeWidth=function(a){return arguments.length?(l=a,b):l},b.startAngle=function(a){return arguments.length?(n=a,b):n},b.range=function(a){return arguments.length?(o=a,b):o},b.symmetric=function(a){return arguments.length?(p=a,b):p},b.knobWidth=function(a){return arguments.length?(m=a,b):m},b.svgClass=function(a){return arguments.length?(f=a,b):f},b.backClass=function(a){return arguments.length?(g=a,b):g},b.chosenClass=function(a){return arguments.length?(h=a,b):h},b.knobClass=function(a){return arguments.length?(i=a,b):i},b.onChange=function(a){return arguments.length?(q=a,b):q},b}return"undefined"==typeof a.elts&&(a.elts={}),a.elts.probWheel=b,a}(d3),d3=function(a){"use strict";function b(){function b(b){b.each(function(b){function n(b){return function(){a.select(this).attr("fill",b?j:i)}}var o=a.select(this).selectAll("svg."+k).data([b]),p=o.enter().append("svg");p.attr("class",k).append("g"),o.attr("width",d).attr("height",e);var q=o.select("g").attr("transform","translate("+c.left+","+c.top+")"),r=q.selectAll("."+l).data(b,function(a){return a.name});r.enter().append("text").attr("class",l).attr("x",0).attr("y",function(a,b){return b*h*g}).attr("dy",".55em").attr("font-size",g).attr("fill",i).attr("cursor","pointer").text(function(a){return a.name}).style("fill-opacity",1e-6),r.on("mouseover",n(!0)).on("mouseout",n(!1)).on("click",m),r.transition().duration(f).style("fill-opacity",1).text(function(a){return a.name}),r.exit().remove()})}var c={top:20,right:20,bottom:20,left:20},d=600,e=1e3,f=300,g=24,h=1.5,i="black",j="orange",k="simple-list",l="list-item",m=function(){};return b.margin=function(a){return arguments.length?(c=a,b):c},b.width=function(a){return arguments.length?(d=a,b):d},b.height=function(a){return arguments.length?(e=a,b):e},b.duration=function(a){return arguments.length?(f=a,b):f},b.lineHeight=function(a){return arguments.length?(h=a,b):h},b.fontSize=function(a){return arguments.length?(g=a,b):g},b.fontColor=function(a){return arguments.length?(i=a,b):i},b.highlightColor=function(a){return arguments.length?(j=a,b):j},b.onClick=function(a){return arguments.length?(m=a,b):m},b.svgClass=function(a){return arguments.length?(k=a,b):k},b.listItemClass=function(a){return arguments.length?(l=a,b):l},b}return"undefined"==typeof a.elts&&(a.elts={}),a.elts.simpleList=b,a}(d3),d3=function(a,b){"use strict";function c(){function c(c){function x(a){return"undefined"==typeof a.minRange?k||0:a.minRange}function y(a){return"undefined"==typeof a.maxRange?l:a.maxRange}function z(b,c){var d=0,g=a.select(this),h=a.select(this.parentNode).select(".slider-start"),i=a.select(this.parentNode).select(".slider-end"),j=+g.attr("x")+C+a.event.dx-d;0>j&&0===C&&(d=j,j=0);var k=+i.attr("x")+C+a.event.dx-d;k+q>e&&0===C&&(d=k+q-e,k=e-q,j-=d),j>=0&&e>=k+q?(g.attr("x",j),h.attr("x",j),i.attr("x",k),b.start=f[c].invert(j),b.end=f[c].invert(k+q),C=d):C+=a.event.dx}function A(b,c){var d=a.select(this),g=a.select(this.parentNode).select(".slider-between"),h=a.event.x;0>h&&(h=0);var i=+g.attr("x")+ +g.attr("width")-h;h>=0&&e>=h&&b.end-f[c].invert(h)>=x(b,c)&&(!y(b,c)||b.end-f[c].invert(h)<=y(b,c))&&(d.attr("x",h),g.attr("x",h),g.attr("width",i),b.start=f[c].invert(h))}function B(b,c){var d=a.select(this),g=a.select(this.parentNode).select(".slider-between"),h=a.event.x;h>e-q&&(h=e-q);var i=h-+d.attr("x")+ +g.attr("width");h>=0&&e-q>=h&&f[c].invert(h)-b.start>=x(b,c)&&(!y(b,c)||f[c].invert(h)-b.start<=y(b,c))&&(d.attr("x",h),g.attr("width",i),b.end=f[c].invert(h))}var C=0;c.each(function(c){function k(b,c){return a.behavior.drag().on("drag",function(a,c){b.call(this,a,c),s(a.start,a.end)}).on("dragstart",function(b){t(b.start,b.end),C=0,"grabbing"===c&&a.select(this).style("cursor","grabbing")}).on("dragend",function(b){u(b.start,b.end),"grabbing"===c&&a.select(this).style("cursor","grab")})}var l=a.select(this);d=i-g.top-g.bottom,e=h-g.left-g.right,f=[],b.each(c,function(a){f.push("undefined"!=typeof a.scale?a.scale.range([0,e]):j.range([0,e]))});var x=l.selectAll("svg."+v).data(c),y=x.enter().append("svg"),D=y.attr("class",v).append("g"),E=D.append("linearGradient").attr("id",w).attr("x1",0).attr("x2",1).attr("y1",0).attr("y2",0);E.append("stop").attr("class","stop-1").attr("offset","0%").attr("stop-color",r[0]),E.append("stop").attr("class","stop-2").attr("offset","100%").attr("stop-color",r[1]),D.append("line").attr("class","slider-full-line").attr("stroke",a.functor(m)).attr("stroke-width",n).attr("x1",0).attr("y1",d/2).attr("x2",e).attr("y2",d/2),D.append("rect").attr("class","slider-between"),D.append("rect").attr("class","slider-start"),D.append("rect").attr("class","slider-end");var F=x.select("g");F.select(".slider-between").attr("fill","url(#"+w+")").attr("x",function(a,b){return f[b](a.start)}).attr("y",(d-o)/2).attr("width",function(a,b){return f[b](a.end)-f[b](a.start)}).attr("height",o).style("cursor","grab").call(k(z,"grabbing")),F.select(".slider-start").attr("fill",a.functor(p)).attr("x",function(a,b){return f[b](a.start)}).attr("y",(d-o)/2).attr("width",q).attr("height",o).style("cursor","ew-resize").call(k(A,"ew-resize")),F.select(".slider-end").attr("fill",a.functor(p)).attr("x",function(a,b){return f[b](a.end)-q}).attr("y",(d-o)/2).attr("width",q).attr("height",o).style("cursor","ew-resize").call(k(B)),x.attr("width",h).attr("height",i),F.attr("transform","translate("+g.left+","+g.top+")"),F.select(".line").attr("stroke",m).attr("stroke-width",n)})}var d,e,f,g={top:0,right:0,bottom:0,left:0},h=500,i=30,j=a.time.scale().domain([new Date("2000-01-01"),new Date("2004-12-31")]),k=31536e6,l=null,m="gray",n=1,o=20,p="#666",q=12,r=["lightgray","gray"],s=function(){},t=function(){},u=function(){},v="start-end-slider",w="gradient-startendslider";return c.margin=function(a){return arguments.length?(g=a,c):g},c.width=function(a){return arguments.length?(h=a,c):h},c.height=function(a){return arguments.length?(i=a,c):i},c.scale=function(a){return arguments.length?(j=a,c):j},c.minRange=function(a){return arguments.length?(k=a,c):k},c.maxRange=function(a){return arguments.length?(l=a,c):l},c.strokeColor=function(a){return arguments.length?(m=a,c):m},c.strokeWidth=function(a){return arguments.length?(n=a,c):n},c.betweenRectHeight=function(a){return arguments.length?(o=a,c):o},c.knobFill=function(a){return arguments.length?(p=a,c):p},c.knobWidth=function(a){return arguments.length?(q=a,c):q},c.fillColor=function(a){return arguments.length?(r=a,c):r},c.onDrag=function(a){return arguments.length?(s=a,c):s},c.onDragEnd=function(a){return arguments.length?(u=a,c):u},c.onDragStart=function(a){return arguments.length?(t=a,c):t},c.svgClass=function(a){return arguments.length?(v=a,c):v},c.gradientId=function(a){return arguments.length?(w=a,c):w},c}return"undefined"==typeof a.elts&&(a.elts={}),a.elts.startEndSlider=c,a}(d3,_),d3=function(a,b){"use strict";function c(){function c(a){return q(a[0])}function d(a){return r(a[1])}function e(d,f){function p(a){a.priority===O&&(a.show=!1)}function G(a){return a.show?a.priority||0:1e6}function L(){K=[],e(d,f)}var M=j-(B?B.height():0);g=a.extent(f,function(a){return a[0]}),J||(J=g);var N=a.bisector(function(a){return a[0]}).left;b.each(D,function(a){a.start=o([a.startDate]),a.end=o([a.endDate||a.startDate]),a.show=a.start>=J[0]&&a.start<=J[1],a.startPos=N(f,a.start),a.endPos=N(f,a.end),a.startY=a.startPos>=0&&a.startPos<f.length?f[a.startPos][1]:0});for(var O=b.min(D,function(a){return a.show?a.priority||0:1e6}).priority;b.filter(D,function(a){return a.show}).length>C&&"undefined"!=typeof O;)b.each(D,p),O=b.min(D,G).priority;q.domain(J).range([0,i-h.left-h.right]);var P=b.filter(f,function(a){return a[0]>=J[0]&&a[0]<=J[1]});r.domain([a.min(f,function(a){return a[1]}),a.max(f,function(a){return a[1]})]).range([M-h.top-h.bottom,0]);var Q=a.select(d).selectAll("svg."+l).data([P]),R=Q.enter().append("svg"),S=R.attr("class",l).append("g"),T=S.append("linearGradient").attr("id",n).attr("x1",0).attr("x2",1).attr("y1",0).attr("y2",0);T.append("stop").attr("class","stop-1").attr("offset","0%").attr("stop-color",z[0]),T.append("stop").attr("class","stop-2").attr("offset","100%").attr("stop-color",z[1]),S.append("path").attr("class","area").attr("fill","url(#"+n+")").attr("d",a.svg.area().x(c).y1(function(){return r(0)}).y0(r(0))),S.append("path").attr("class","line").attr("stroke",y).attr("stroke-width",A).attr("fill","none").attr("d",a.svg.line().x(c).y(function(){return r(0)})),S.append("g").attr("class","x axis").attr("transform","translate(0,"+r(0)+")"),S.append("g").attr("class","y axis").attr("transform","translate("+q(0)+",0)"),S.append("g").attr("class","notes"),Q.attr("width",i).attr("height",M);var U=Q.select("g").attr("transform","translate("+h.left+","+h.top+")");if(U.select(".area").transition().duration(k).attr("d",w.y0(r(0))),U.select("#"+n+" stop.stop-1").transition().duration(k).attr("stop-color",z[0]),U.select("#"+n+" stop.stop-2").transition().duration(k).attr("stop-color",z[1]),U.select(".line").transition().duration(k).attr("stroke",y).attr("stroke-width",A).attr("d",x),U.select(".x.axis").transition().duration(k).attr("transform","translate(0,"+r.range()[0]+")").call(s).selectAll("text").call(t),U.select(".x.axis").selectAll("text").call(t),v){var V=Math.max(Math.abs(r.domain()[0]),Math.abs(r.domain()[1]));u.tickFormat(V>2?a.format("g"):V>=.04?a.format("%"):V>.003?a.format(".1%"):V>3e-4?a.format(".2%"):a.format("g"))}U.select(".y.axis").transition().duration(k).attr("transform","translate("+q.range()[0]+", 0)").call(u);var W=K?f.slice(K[0],K[1]+1):[],X=U.selectAll("."+m).data([W]);X.enter().append("path").attr("class",m),X.attr("fill","#000000").style("opacity",.2).attr("d",w.y0(r(0)));var Y=U.select(".notes").selectAll(".note").data(b.filter(D,function(a){return a.show&&(a.priority||0)>=(O||0)}),I);Y.enter().append("circle").attr("class","note").attr("r",0).style("opacity",1e-6).attr("fill",y).attr("cy",function(a){return r(a.startY)}).style("cursor","pointer"),0===k&&Y.attr("cx",function(a){return q(a.start)}),Y.on("click",function(a){H(this,a,L),K=[a.startPos,a.endPos],e(d,f)}).transition().duration(k).attr("fill",y).attr("cx",function(a){return q(a.start)}).attr("cy",function(a){return r(a.startY)}).transition().duration(k).attr(E).style(F),Y.exit().remove()}function f(c){c.each(function(c){var d=this,f=b.map(c,function(a,b){return[o.call(c,a,b),p.call(c,a,b)]});K=[],H(),e(d,f),J?L(f,J[0],J[1]):L(f),B&&(B.width(i).margin({top:0,right:h.right,bottom:0,left:h.left}),B.onDrag(function(a,b){J=[a,b];var c=k;k=0,e(d,f),k=c,L(f,a,b)}),a.select(d).datum([{scale:q.copy().domain(g),start:J?J[0]:g[0],end:J?J[1]:g[1]}]).call(B))})}var g,h={top:10,right:20,bottom:120,left:60},i=760,j=120,k=500,l="time-series-chart",m="highlighted-area",n="gradient-timeseries-fill",o=function(a){return a[0]},p=function(a){return+a[1]},q=a.time.scale(),r=a.scale.linear(),s=a.svg.axis().scale(q).orient("bottom").tickSize(6,0),t=function(a){a.attr("x",-8).attr("y",0).attr("dy",".35em").attr("transform","rotate(-90)").style("text-anchor","end")},u=a.svg.axis().scale(r).orient("left").ticks(6).tickSize(6,0),v=!1,w=a.svg.area().x(c).y1(d),x=a.svg.line().x(c).y(d),y="gray",z=["lightgray","gray"],A=1,B=null,C=7,D=null,E={r:10,stroke:"white","stroke-width":1},F={opacity:.82},G=500,H=function(a,b,c){console.log(a,b,c)},I=function(a){return[a.startDate,a.endDate,a.title].join("-")},J=null,K=null,L=function(){};return f.margin=function(a){return arguments.length?(h=a,f):h},f.width=function(a){return arguments.length?(i=a,f):i},f.height=function(a){return arguments.length?(j=a,f):j},f.duration=function(a){return arguments.length?(k=a,f):k},f.x=function(a){return arguments.length?(o=a,f):o},f.y=function(a){return arguments.length?(p=a,f):p},f.xAxis=function(a){return arguments.length?(s=a,f):s},f.yAxis=function(a){return arguments.length?(u=a,f):u},f.xAxisText=function(a){return arguments.length?(t=a,f):t},f.smartYFormat=function(a){return arguments.length?(v=a,f):v},f.strokeWidth=function(a){return arguments.length?(A=a,f):A},f.strokeColor=function(a){return arguments.length?(y=a,f):y},f.fillColor=function(a){return arguments.length?(z=a,f):z},f.xDomain=function(a){return arguments.length?(J=a,f):J},f.maxNotes=function(a){return arguments.length?(C=a,f):C},f.notes=function(a){return arguments.length?(D=a,f):D},f.notesMarkerAttr=function(a){return arguments.length?(E=a,f):E},f.notesMarkerStyle=function(a){return arguments.length?(F=a,f):F},f.notesMarkerClick=function(a){return arguments.length?(H=a,f):H},f.notesMarkerDuration=function(a){return arguments.length?(G=a,f):G},f.notesUniqueId=function(a){return arguments.length?(I=a,f):I},f.rangeWidget=function(a){return arguments.length?(B=a,f):B},f.highlightRange=function(a){return arguments.length?(K=a,f):K},f.onRangeChange=function(a){return arguments.length?(L=a,f):L},f.svgClass=function(a){return arguments.length?(l=a,f):l},f.highlightedAreaClass=function(a){return arguments.length?(m=a,f):m},f.gradientId=function(a){return arguments.length?(n=a,f):n},f}return"undefined"==typeof a.elts&&(a.elts={}),a.elts.timeSeriesChart=c,a}(d3,_),d3=function(a){"use strict";function b(){function b(a){return a._children?"#999999":"#CCCCCC"}function c(){return"steelblue"}function d(a){a.children&&(a._children=a.children,a.children=null)}function e(a){a._children&&(a.children=a._children,a._children=null)}function f(a){a.parent&&a.parent.children.forEach(d),e(a),a.parent&&f(a.parent)}function g(a){a&&a.children&&(a.children.forEach(g),d(a))}function h(a,b){return function(c){a.selectAll(".node circle").filter(function(a){return c.id===a.id}).transition().duration(n/2).attr("r",o*b)}}function i(a){return a.parent?a.parent:a}function j(d){function e(d){return function(e){d.selectAll(".node circle").filter(function(a){return e.id!==a.id}).style("fill",a.functor(b)),d.selectAll(".node circle").filter(function(a){return e.id===a.id}).style("fill",a.functor(c))}}function j(c,d){var g="undefined"!=typeof d.rotation?d.rotation:0,C="undefined"!=typeof d.colorName?d.colorName:C;y.size([k,l]),d.x0=k/2,d.y0=0;var D=y.nodes(d).reverse(),E=a.select(c).selectAll("g."+v).data([d]);E.enter().append("g").attr("class",v).attr("transform",function(){return"rotate("+g+","+d.x+","+d.y+")"}),E.transition().duration(n).attr("transform",function(){return"translate("+-d.x+","+-d.y+") rotate("+g+","+d.x+","+d.y+")"}),D.forEach(function(a){a.y=a.depth*m});var F=E.selectAll("g.node").data(D,function(a){return a.id||(a.id=++u)}),G=F.enter().append("svg:g").attr("class","node").attr("transform",function(a){var b=i(a);return"translate("+b.x0+","+b.y0+")"}).on("mouseover",function(a,b){w?z(this,a,"<div class='"+w+"'>"+a[x]+"</div>"):z(this,a,a[x]),h(E,s)(a,b)}).on("mouseout",function(a,b){A(this,a,a[x]),h(E,1)(a,b)}).on("click",function(b,g){if(h(E,1)(b,g),f(b),e(E,C)(b,g),j(c,d),t){t.colorName(C);var i="undefined"!=typeof d.infoElement?d.infoElement:a.select("body");i.datum([b]).call(t.show())}});G.append("svg:circle").attr("r",1e-6).style("fill",a.functor(b)).style("stroke-width",a.functor(r)).style("opacity",1),F.style("fill",a.functor(b)).style("stroke-width",a.functor(r));var H=F.transition().duration(n).attr("transform",function(a){return"translate("+a.x+","+a.y+")"});H.select("circle").attr("r",o).style("opacity",1),H.selectAll("text").style("fill-opacity",1);var I=F.exit().transition().duration(n).attr("transform",function(a){var b=i(a);return"translate("+b.x+","+b.y+")"}).remove();I.select("circle").attr("r",1e-6),I.select("text").style("fill-opacity",1e-6);var J=E.selectAll("path.link").data(y.links(D),function(a){return a.target.id});J.enter().insert("svg:path","g").attr("class","link").style("stroke",a.functor(p)).style("stroke-width",a.functor(q)).style("fill","none").attr("d",function(a){var b={x:a.source.x0,y:a.source.y0};return B({source:b,target:b})}).transition().duration(n).attr("d",B),J.transition().duration(n).attr("d",B),J.exit().transition().duration(n).attr("d",function(a){var b={x:a.source.x,y:a.source.y};return B({source:b,target:b})}).remove(),D.forEach(function(a){a.x0=a.x,a.y0=a.y})}var u=0,y=a.layout.tree(),B=a.svg.diagonal().projection(function(a){return[a.x,a.y]});d.each(function(a){a.children&&a.children.forEach(g),j(this,a)})}var k=1,l=1,m=1,n=500,o=.1,p="#CCCCCC",q=.02,r=.01,s=1.25,t=null,u={},v="tree-diagram",w="",x="name",y="blue",z=function(){},A=function(){};return j.width=function(a){return arguments.length?(k=a,j):k},j.height=function(a){return arguments.length?(l=a,j):l},j.levelSpacing=function(a){return arguments.length?(m=a,j):m},j.infoWidget=function(a){return arguments.length?(t=a,j):t},j.linkStrokeColor=function(a){return arguments.length?(p=a,j):p},j.linkStrokeWidth=function(a){return arguments.length?(q=a,j):q},j.mouseOver=function(a){return arguments.length?(z=a,j):z},j.mouseOut=function(a){return arguments.length?(A=a,j):A},j.treeShades=function(a){return arguments.length?(u=a,j):u},j.treeClass=function(a){return arguments.length?(v=a,j):v},j.wrapHoverLabelClass=function(a){return arguments.length?(w=a,j):w},j.nameField=function(a){return arguments.length?(x=a,j):x},j.colorName=function(a){return arguments.length?(y=a,j):y},j.nodeFill=function(a){return arguments.length?(b=a,j):b},j.selectedNodeFill=function(a){return arguments.length?(c=a,j):c},j}return"undefined"==typeof a.elts&&(a.elts={}),a.elts.treeDiagram=b,a}(d3),d3=function(a){"use strict";function b(){function b(a){return m(a[0])}function c(a){return n(a[1])}function d(c,d){function e(a){return function(){return"undefined"==typeof w[a%w.length][2]?w[a%w.length][0]:w[a%w.length][2]}}function A(a){return function(){return v[a%v.length]}}function B(a){return m(a[0])}function C(a){return n(a[1])}var D,E,F,G=1/0,H=-1/0,I=1/0,J=-1/0;for(D=0;D<d.length;D++)H=Math.max(H,a.max(d[D],function(a){return a[0]})),G=Math.min(G,a.min(d[D],function(a){return a[0]})),J=Math.max(J,a.max(d[D],function(a){return a[1]})),I=Math.min(I,a.min(d[D],function(a){return a[1]}));m.domain([G,H]).range([0,g-f.left-f.right]),n.domain([I,J]).range([h-f.top-f.bottom,0]);var K=a.select(c).selectAll("svg."+j).data([1]),L=K.enter().append("svg").attr("class",j).append("g"),M=K.select("g").selectAll("."+k).data(d),N=M.enter().append("g").attr("class",k);M.exit().remove();var O=N.append("linearGradient").attr("class",l).attr("id",function(a,b){return l+"-"+b}).attr("x1",0).attr("x2",1).attr("y1",0).attr("y2",0);for(O.append("stop").attr("class","stop-1").attr("offset","0%").attr("stop-color",function(a,b){return w[b%w.length][0]}),O.append("stop").attr("class","stop-2").attr("offset","100%").attr("stop-color",function(a,b){return w[b%w.length][1]}),N.append("path").attr("class","area").attr("fill",function(a,b){return"undefined"==typeof w[b%w.length][1]?w[b%w.length][0]:"url(#"+l+"-"+b+")"}).attr("opacity",z).attr("d",function(c,d){return s[d]&&s[d].indexOf("area")>=0?a.svg.area().x(b).y1(function(){return n(0)}).y0(n(0)).apply(this,arguments):null}),N.append("path").attr("class","line").attr("stroke",function(a,b){return v[b%v.length]}).attr("stroke-width",x).attr("fill","none").attr("d",function(c,d){return!s[d]||s[d]&&s[d].indexOf("line")>=0?a.svg.line().x(b).y(function(){return n(0)}).apply(this,arguments):void 0}),N.append("g").attr("class",function(a,b){return"points-"+b}),L.append("g").attr("class","x axis").attr("transform","translate(0,"+n(0)+")"),L.append("g").attr("class","y axis").attr("transform","translate("+m(0)+",0)"),K.attr("width",g).attr("height",h),K.select("g").attr("transform","translate("+f.left+","+f.top+")"),D=0;D<d.length;D++)E=s[D]&&s[D].indexOf("point")>=0?d[D]:[],F=M.select(".points-"+D).selectAll(".point").data(E),F.enter().append("circle").attr("class","point").attr("r",0).style("opacity",1e-6).attr("fill",e(D)).attr("stroke",A(D)).attr("stroke-width",x).attr("cx",B).attr("cy",n(0)),F.transition().duration(i).style("opacity",1).attr("r",y).attr("cx",B).attr("cy",C),F.exit().remove();M.select(".area").transition().duration(i).attr("d",function(a,b){return s[b]&&s[b].indexOf("area")>=0?t.y0(n(0)).apply(this,arguments):void 0}),M.select("."+l+" stop.stop-1").transition().duration(i).attr("stop-color",function(a,b){return w[b%w.length][0]
}),M.select("."+l+" stop.stop-2").transition().duration(i).attr("stop-color",function(a,b){return w[b%w.length][1]}),M.select(".line").transition().duration(i).attr("stroke",function(a,b){return v[b%v.length]}).attr("stroke-width",x).attr("d",function(a,b){return!s[b]||s[b]&&s[b].indexOf("line")>=0?u.apply(this,arguments):void 0});var P=K.select("g");if(P.select(".x.axis").transition().duration(i).attr("transform","translate(0,"+n.range()[0]+")").call(o).selectAll("text").call(q),P.select(".x.axis").selectAll("text").call(q),r){var Q=Math.max(Math.abs(n.domain()[0]),Math.abs(n.domain()[1]));p.tickFormat(Q>2?a.format("g"):Q>=.04?a.format("%"):Q>.003?a.format(".1%"):Q>3e-4?a.format(".2%"):a.format("g"))}P.select(".y.axis").transition().duration(i).attr("transform","translate("+m.range()[0]+", 0)").call(p)}function e(a){a.each(function(a){var b=this;d(b,a)})}var f={top:10,right:20,bottom:120,left:60},g=760,h=120,i=500,j="xy-chart",k="xy-plot",l="gradient-xy-fill",m=a.scale.linear(),n=a.scale.linear(),o=a.svg.axis().scale(m).orient("bottom").tickSize(6,0),p=a.svg.axis().scale(n).orient("left").ticks(6).tickSize(6,0),q=function(){},r=!1,s=["area line points"],t=a.svg.area().x(b).y1(c),u=a.svg.line().x(b).y(c),v=["gray"],w=[["lightgray","gray","white"]],x=1,y=5,z=.67;return e.margin=function(a){return arguments.length?(f=a,e):f},e.width=function(a){return arguments.length?(g=a,e):g},e.height=function(a){return arguments.length?(h=a,e):h},e.duration=function(a){return arguments.length?(i=a,e):i},e.xAxis=function(a){return arguments.length?(o=a,e):o},e.yAxis=function(a){return arguments.length?(p=a,e):p},e.chartTypes=function(a){return arguments.length?(s=a,e):s},e.smartYFormat=function(a){return arguments.length?(r=a,e):r},e.strokeWidth=function(a){return arguments.length?(x=a,e):x},e.strokeColor=function(a){return arguments.length?(v=a,e):v},e.fillColor=function(a){return arguments.length?(w=a,e):w},e.pointRadius=function(a){return arguments.length?(y=a,e):y},e.opacity=function(a){return arguments.length?(z=a,e):z},e.svgClass=function(a){return arguments.length?(j=a,e):j},e.plotClass=function(a){return arguments.length?(k=a,e):k},e.gradientPrefix=function(a){return arguments.length?(l=a,e):l},e}return"undefined"==typeof a.elts&&(a.elts={}),a.elts.xyChart=b,a}(d3);